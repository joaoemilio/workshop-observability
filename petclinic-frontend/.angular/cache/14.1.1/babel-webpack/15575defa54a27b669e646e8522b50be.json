{"ast":null,"code":"import { Promise } from './polyfills';\nvar slice = [].slice;\nvar isBrowser = typeof window !== 'undefined';\nvar PERF = isBrowser && typeof performance !== 'undefined' ? performance : {};\n\nfunction isCORSSupported() {\n  var xhr = new window.XMLHttpRequest();\n  return 'withCredentials' in xhr;\n}\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToHex(buffer) {\n  var hexOctets = [];\n\n  for (var _i = 0; _i < buffer.length; _i++) {\n    hexOctets.push(byteToHex[buffer[_i]]);\n  }\n\n  return hexOctets.join('');\n}\n\nvar destination = new Uint8Array(16);\n\nfunction rng() {\n  if (typeof crypto != 'undefined' && typeof crypto.getRandomValues == 'function') {\n    return crypto.getRandomValues(destination);\n  } else if (typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function') {\n    return msCrypto.getRandomValues(destination);\n  }\n\n  return destination;\n}\n\nfunction generateRandomId(length) {\n  var id = bytesToHex(rng());\n  return id.substr(0, length);\n}\n\nfunction getDtHeaderValue(span) {\n  var dtVersion = '00';\n  var dtUnSampledFlags = '00';\n  var dtSampledFlags = '01';\n\n  if (span && span.traceId && span.id && span.parentId) {\n    var flags = span.sampled ? dtSampledFlags : dtUnSampledFlags;\n    var id = span.sampled ? span.id : span.parentId;\n    return dtVersion + '-' + span.traceId + '-' + id + '-' + flags;\n  }\n}\n\nfunction parseDtHeaderValue(value) {\n  var parsed = /^([\\da-f]{2})-([\\da-f]{32})-([\\da-f]{16})-([\\da-f]{2})$/.exec(value);\n\n  if (parsed) {\n    var flags = parsed[4];\n    var sampled = flags !== '00';\n    return {\n      traceId: parsed[2],\n      id: parsed[3],\n      sampled: sampled\n    };\n  }\n}\n\nfunction isDtHeaderValid(header) {\n  return /^[\\da-f]{2}-[\\da-f]{32}-[\\da-f]{16}-[\\da-f]{2}$/.test(header) && header.slice(3, 35) !== '00000000000000000000000000000000' && header.slice(36, 52) !== '0000000000000000';\n}\n\nfunction getTSHeaderValue(_ref) {\n  var sampleRate = _ref.sampleRate;\n\n  if (typeof sampleRate !== 'number' || String(sampleRate).length > 256) {\n    return;\n  }\n\n  var NAMESPACE = 'es';\n  var SEPARATOR = '=';\n  return \"\" + NAMESPACE + SEPARATOR + \"s:\" + sampleRate;\n}\n\nfunction setRequestHeader(target, name, value) {\n  if (typeof target.setRequestHeader === 'function') {\n    target.setRequestHeader(name, value);\n  } else if (target.headers && typeof target.headers.append === 'function') {\n    target.headers.append(name, value);\n  } else {\n    target[name] = value;\n  }\n}\n\nfunction checkSameOrigin(source, target) {\n  var isSame = false;\n\n  if (typeof target === 'string') {\n    isSame = source === target;\n  } else if (target && typeof target.test === 'function') {\n    isSame = target.test(source);\n  } else if (Array.isArray(target)) {\n    target.forEach(function (t) {\n      if (!isSame) {\n        isSame = checkSameOrigin(source, t);\n      }\n    });\n  }\n\n  return isSame;\n}\n\nfunction isPlatformSupported() {\n  return isBrowser && typeof Set === 'function' && typeof JSON.stringify === 'function' && PERF && typeof PERF.now === 'function' && isCORSSupported();\n}\n\nfunction setLabel(key, value, obj) {\n  if (!obj || !key) return;\n  var skey = removeInvalidChars(key);\n  var valueType = typeof value;\n\n  if (value != undefined && valueType !== 'boolean' && valueType !== 'number') {\n    value = String(value);\n  }\n\n  obj[skey] = value;\n  return obj;\n}\n\nfunction getServerTimingInfo(serverTimingEntries) {\n  if (serverTimingEntries === void 0) {\n    serverTimingEntries = [];\n  }\n\n  var serverTimingInfo = [];\n  var entrySeparator = ', ';\n  var valueSeparator = ';';\n\n  for (var _i2 = 0; _i2 < serverTimingEntries.length; _i2++) {\n    var _serverTimingEntries$ = serverTimingEntries[_i2],\n        name = _serverTimingEntries$.name,\n        duration = _serverTimingEntries$.duration,\n        description = _serverTimingEntries$.description;\n    var timingValue = name;\n\n    if (description) {\n      timingValue += valueSeparator + 'desc=' + description;\n    }\n\n    if (duration) {\n      timingValue += valueSeparator + 'dur=' + duration;\n    }\n\n    serverTimingInfo.push(timingValue);\n  }\n\n  return serverTimingInfo.join(entrySeparator);\n}\n\nfunction getTimeOrigin() {\n  return PERF.timing.fetchStart;\n}\n\nfunction stripQueryStringFromUrl(url) {\n  return url && url.split('?')[0];\n}\n\nfunction isObject(value) {\n  return value !== null && typeof value === 'object';\n}\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction baseExtend(dst, objs, deep) {\n  for (var i = 0, ii = objs.length; i < ii; ++i) {\n    var obj = objs[i];\n    if (!isObject(obj) && !isFunction(obj)) continue;\n    var keys = Object.keys(obj);\n\n    for (var j = 0, jj = keys.length; j < jj; j++) {\n      var key = keys[j];\n      var src = obj[key];\n\n      if (deep && isObject(src)) {\n        if (!isObject(dst[key])) dst[key] = Array.isArray(src) ? [] : {};\n        baseExtend(dst[key], [src], false);\n      } else {\n        dst[key] = src;\n      }\n    }\n  }\n\n  return dst;\n}\n\nfunction getElasticScript() {\n  if (typeof document !== 'undefined') {\n    var scripts = document.getElementsByTagName('script');\n\n    for (var i = 0, l = scripts.length; i < l; i++) {\n      var sc = scripts[i];\n\n      if (sc.src.indexOf('elastic') > 0) {\n        return sc;\n      }\n    }\n  }\n}\n\nfunction getCurrentScript() {\n  if (typeof document !== 'undefined') {\n    var currentScript = document.currentScript;\n\n    if (!currentScript) {\n      return getElasticScript();\n    }\n\n    return currentScript;\n  }\n}\n\nfunction extend(dst) {\n  return baseExtend(dst, slice.call(arguments, 1), false);\n}\n\nfunction merge(dst) {\n  return baseExtend(dst, slice.call(arguments, 1), true);\n}\n\nfunction isUndefined(obj) {\n  return typeof obj === 'undefined';\n}\n\nfunction noop() {}\n\nfunction find(array, predicate, thisArg) {\n  if (array == null) {\n    throw new TypeError('array is null or not defined');\n  }\n\n  var o = Object(array);\n  var len = o.length >>> 0;\n\n  if (typeof predicate !== 'function') {\n    throw new TypeError('predicate must be a function');\n  }\n\n  var k = 0;\n\n  while (k < len) {\n    var kValue = o[k];\n\n    if (predicate.call(thisArg, kValue, k, o)) {\n      return kValue;\n    }\n\n    k++;\n  }\n\n  return undefined;\n}\n\nfunction removeInvalidChars(key) {\n  return key.replace(/[.*\"]/g, '_');\n}\n\nfunction getLatestSpan(spans, typeFilter) {\n  var latestSpan = null;\n\n  for (var _i3 = 0; _i3 < spans.length; _i3++) {\n    var span = spans[_i3];\n\n    if (typeFilter && typeFilter(span.type) && (!latestSpan || latestSpan._end < span._end)) {\n      latestSpan = span;\n    }\n  }\n\n  return latestSpan;\n}\n\nfunction getLatestNonXHRSpan(spans) {\n  return getLatestSpan(spans, function (type) {\n    return String(type).indexOf('external') === -1;\n  });\n}\n\nfunction getLatestXHRSpan(spans) {\n  return getLatestSpan(spans, function (type) {\n    return String(type).indexOf('external') !== -1;\n  });\n}\n\nfunction getEarliestSpan(spans) {\n  var earliestSpan = spans[0];\n\n  for (var _i4 = 1; _i4 < spans.length; _i4++) {\n    var span = spans[_i4];\n\n    if (earliestSpan._start > span._start) {\n      earliestSpan = span;\n    }\n  }\n\n  return earliestSpan;\n}\n\nfunction now() {\n  return PERF.now();\n}\n\nfunction getTime(time) {\n  return typeof time === 'number' && time >= 0 ? time : now();\n}\n\nfunction getDuration(start, end) {\n  if (isUndefined(end) || isUndefined(start)) {\n    return null;\n  }\n\n  return parseInt(end - start);\n}\n\nfunction scheduleMacroTask(callback) {\n  setTimeout(callback, 0);\n}\n\nfunction scheduleMicroTask(callback) {\n  Promise.resolve().then(callback);\n}\n\nfunction isPerfTimelineSupported() {\n  return typeof PERF.getEntriesByType === 'function';\n}\n\nfunction isPerfTypeSupported(type) {\n  return typeof PerformanceObserver !== 'undefined' && PerformanceObserver.supportedEntryTypes && PerformanceObserver.supportedEntryTypes.indexOf(type) >= 0;\n}\n\nfunction isBeaconInspectionEnabled() {\n  var flagName = '_elastic_inspect_beacon_';\n\n  if (sessionStorage.getItem(flagName) != null) {\n    return true;\n  }\n\n  if (!window.URL || !window.URLSearchParams) {\n    return false;\n  }\n\n  try {\n    var parsedUrl = new URL(window.location.href);\n    var isFlagSet = parsedUrl.searchParams.has(flagName);\n\n    if (isFlagSet) {\n      sessionStorage.setItem(flagName, true);\n    }\n\n    return isFlagSet;\n  } catch (e) {}\n\n  return false;\n}\n\nexport { extend, merge, isUndefined, noop, baseExtend, bytesToHex, isCORSSupported, isObject, isFunction, isPlatformSupported, isDtHeaderValid, parseDtHeaderValue, getServerTimingInfo, getDtHeaderValue, getTSHeaderValue, getCurrentScript, getElasticScript, getTimeOrigin, generateRandomId, getEarliestSpan, getLatestNonXHRSpan, getLatestXHRSpan, getDuration, getTime, now, rng, checkSameOrigin, scheduleMacroTask, scheduleMicroTask, setLabel, setRequestHeader, stripQueryStringFromUrl, find, removeInvalidChars, PERF, isPerfTimelineSupported, isBrowser, isPerfTypeSupported, isBeaconInspectionEnabled };","map":null,"metadata":{},"sourceType":"module"}